<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Redirecting to secure checkout…</title>
<style>
  body{font:16px system-ui,Segoe UI,Roboto,sans-serif;padding:24px}
</style>
<script>
  // 1) Read q from the URL (?q=Qxxxx)
  const params = new URLSearchParams(location.search);
  const q = params.get('q');
  // 2) Your deployed Apps Script web app URL (latest /exec, access: Anyone)
  const APPS_SCRIPT_EXEC = "https://script.google.com/macros/s/AKfycbyFQ_9M07jtexxLOhTizhN74x3iBGFk0KdVoWvvyxNV6ULbHlVrqjEyL6UbirqCV9wE/exec"; // e.g. https://script.google.com/macros/s/AKfy.../exec

  if (!q || !APPS_SCRIPT_EXEC) {
    document.write("Missing quote id or Apps Script URL.");
  } else {
    const payUrl = APPS_SCRIPT_EXEC + "?action=pay&q=" + encodeURIComponent(q);
    // Top-level navigation to Apps Script (which returns a page that sends you to Stripe)
    location.replace(payUrl);
  }
</script>
<p>Redirecting to secure checkout…</p>
<noscript>Please enable JavaScript and <a id="fallback" href="#">click here</a>.</noscript>
<script>
  // noscript fallback target (in case user enables JS after)
  const a = document.getElementById('fallback');
  if (a && typeof APPS_SCRIPT_EXEC === 'string') {
    const params = new URLSearchParams(location.search);
    const q = params.get('q');
    if (q) a.href = APPS_SCRIPT_EXEC + "?action=pay&q=" + encodeURIComponent(q);
  }
</script>
