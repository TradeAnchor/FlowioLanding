<!doctype html>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Redirecting to secure checkout…</title>
<div style="font:16px system-ui;margin:24px">Opening Stripe…</div>
<script>
(async () => {
  const qid = new URL(location).searchParams.get('q'); // e.g. ?q=Q0047
  if(!qid) { document.body.textContent = 'Missing quote id.'; return; }
  const url = 'https://script.google.com/macros/s/YOUR_DEPLOY_ID/exec?action=pay_json&q=' + encodeURIComponent(qid);
  try {
    const r = await fetch(url, {credentials:'omit'});
    const j = await r.json();
    if (j && j.url) location.replace(j.url);
    else document.body.textContent = 'Could not start checkout.';
  } catch(e){ document.body.textContent = 'Network error.'; }
})();
</script>
